(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pageblock"],{"27d0":function(e,t,n){},"5d9e":function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l}));n("99af"),n("d81d");var o,c=n("e006");(function(e){e["ZH"]="zh_CN"})(o||(o={}));var i={PAGE_INDEX_CTRL_F:{name:"PAGE_INDEX_CTRL_F",value:"ctrl+f",introduce:function(e){switch(e){default:return"<a>搜索框显示</a>"}}},PAGE_INDEX_KEY_N:{name:"PAGE_INDEX_KEY_N",value:"n",introduce:function(e){switch(e){default:return"新建页面"}}},PAGE_INDEX_UP:{name:"PAGE_INDEX_UP",value:"up",introduce:function(e){switch(e){default:return"上一个选项"}}},PAGE_INDEX_RIGHT:{name:"PAGE_INDEX_RIGHT",value:"right",introduce:function(e){switch(e){default:return"右面一个选项"}}},PAGE_INDEX_DOWN:{name:"PAGE_INDEX_DOWN",value:"down",introduce:function(e){switch(e){default:return"下面一个选项"}}},PAGE_INDEX_LEFT:{name:"PAGE_INDEX_LEFT",value:"left",introduce:function(e){switch(e){default:return"左边一个选项"}}},PAGE_INDEX_CTRL_LEFT:{name:"PAGE_INDEX_CTRL_LEFT",value:"ctrl+left",introduce:function(e){switch(e){default:return"返回"}}},PAGE_INDEX_CTRL_RIGHT:{name:"PAGE_INDEX_CTRL_RIGHT",value:"ctrl+right",introduce:function(e){switch(e){default:return"往前"}}}},a={name:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"zh";switch(e){default:return"页面索引"}return"PageIndex"},introduce:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"zh",t=["PAGE_INDEX_CTRL_F","PAGE_INDEX_UP","PAGE_INDEX_RIGHT","PAGE_INDEX_DOWN","PAGE_INDEX_LEFT"];return t=t.concat(["PAGE_INDEX_CTRL_LEFT","PAGE_INDEX_CTRL_RIGHT"]),t.map((function(t){return{name:t,hotkey:Object(c["b"])(i[t]),introduce:i[t].introduce(e)}}))},style:function(){}},r={PAGE_BLOCKS_KEY_N:{name:"PAGE_BLOCKS_KEY_N",value:"n",introduce:function(e){switch(e){default:return"新建块"}}},PAGE_BLOCKS_UP:{name:"PAGE_BLOCKS_UP",value:"up",introduce:function(e){switch(e){default:return"上一个选项"}}},PAGE_BLOCKS_RIGHT:{name:"PAGE_BLOCKS_RIGHT",value:"right",introduce:function(e){switch(e){default:return"右面一个选项"}}},PAGE_BLOCKS_DOWN:{name:"PAGE_BLOCKS_DOWN",value:"down",introduce:function(e){switch(e){default:return"下面一个选项"}}},PAGE_BLOCKS_LEFT:{name:"PAGE_BLOCKS_LEFT",value:"left",introduce:function(e){switch(e){default:return"左边一个选项"}}},PAGE_BLOCKS_CTRL_LEFT:{name:"PAGE_BLOCKS_CTRL_LEFT",value:"ctrl+left",introduce:function(e){switch(e){default:return"返回"}}},PAGE_BLOCKS_CTRL_RIGHT:{name:"PAGE_BLOCKS_CTRL_RIGHT",value:"ctrl+right",introduce:function(e){switch(e){default:return"往前"}}}},u={name:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"zh";switch(e){default:return"页面块"}return"PageBlocks"},introduce:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"zh",t=["PAGE_BLOCKS_KEY_N","PAGE_BLOCKS_UP","PAGE_BLOCKS_RIGHT","PAGE_BLOCKS_DOWN","PAGE_BLOCKS_LEFT"];return t=t.concat(["PAGE_BLOCKS_CTRL_LEFT","PAGE_BLOCKS_CTRL_RIGHT"]),t.map((function(t){return{name:t,hotkey:Object(c["b"])(r[t]),introduce:r[t].introduce(e)}}))},style:function(){}},d={MARKDOWN_UP:{name:"MARKDOWN_UP",value:"up",introduce:function(e){switch(e){default:return"向上"}}},MARKDOWN_RIGHT:{name:"MARKDOWN_RIGHT",value:"right",introduce:function(e){switch(e){default:return"向右"}}},MARKDOWN_DOWN:{name:"MARKDOWN_DOWN",value:"down",introduce:function(e){switch(e){default:return"向下"}}},MARKDOWN_LEFT:{name:"MARKDOWN_LEFT",value:"left",introduce:function(e){switch(e){default:return"向左"}}},MARKDOWN_CTRL_Q:{name:"MARKDOWN_CTRL_Q",value:"ctrl+q",introduce:function(e){switch(e){default:return"隐藏/显示左边markdown编辑"}}},MARKDOWN_CTRL_E:{name:"MARKDOWN_CTRL_E",value:"ctrl+e",introduce:function(e){switch(e){default:return"隐藏/显示右边markdown预览"}}},MARKDOWN_ESC:{name:"MARKDOWN_CTRL_ESC",value:"esc",introduce:function(e){switch(e){default:return"隐藏/显示左边markdown预览"}}}},l={name:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"zh";switch(e){default:return"标记语言Markdown"}return"Markdown"},introduce:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"zh",t=["MARKDOWN_UP","MARKDOWN_RIGHT","MARKDOWN_DOWN","MARKDOWN_LEFT"];return t=t.concat(["MARKDOWN_CTRL_Q","MARKDOWN_CTRL_E","MARKDOWN_ESC"]),t.map((function(t){return{name:t,hotkey:Object(c["b"])(d[t]),introduce:d[t].introduce(e)}}))},style:function(){}}},"74e1":function(e,t,n){},"8d13":function(e,t,n){"use strict";n("27d0")},a3c2:function(e,t,n){"use strict";n("ba85")},ba85:function(e,t,n){},cac9:function(e,t,n){"use strict";n.r(t);var o=n("7a23"),c=Object(o["withScopeId"])("data-v-52c1a1c8");Object(o["pushScopeId"])("data-v-52c1a1c8");var i={class:"page-blocks card padding-12"},a={key:0,class:"hr",style:{width:"80%"}},r=Object(o["createVNode"])("pre",null,"帮助内容",-1),u=Object(o["createVNode"])("pre",null,"帮助内容",-1),d={key:3,class:"no-blocks margin-left-24"};Object(o["popScopeId"])();var l=c((function(e,t){var n=Object(o["resolveComponent"])("WindowHelp"),l=Object(o["resolveComponent"])("Markdown");return Object(o["openBlock"])(),Object(o["createBlock"])("div",i,[Object(o["createVNode"])("div",{class:"page-block-title no-outline",contenteditable:"true",onInput:t[1]||(t[1]=function(){return e.changeTitle.apply(e,arguments)}),onBlur:t[2]||(t[2]=function(){return e.updatePageTitleByBlur.apply(e,arguments)})},Object(o["toDisplayString"])(e.page.title),33),0!==e.blocks.length?(Object(o["openBlock"])(),Object(o["createBlock"])("div",a)):Object(o["createCommentVNode"])("",!0),0!=e.blocks.length&&!e.isNeedHelp||e.showMarkdown?Object(o["createCommentVNode"])("",!0):Object(o["createVNode"])(n,{key:1,helpContent:e.DocPageBlocksHelper},{default:c((function(){return[r]})),_:1},8,["helpContent"]),(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(e.blocks,(function(t){return Object(o["openBlock"])(),Object(o["createBlock"])("div",{class:"page-block-item",key:t.openid},[205===t.type?(Object(o["openBlock"])(),Object(o["createBlock"])("div",{key:0,innerHTML:e.parse(t.value),onClick:function(n){return e.onShowMarkdown(t)}},null,8,["innerHTML","onClick"])):Object(o["createCommentVNode"])("",!0)])})),128)),e.showMarkdown?Object(o["createVNode"])(l,{key:2,markdown:e.markdown,onUpdate:e.update,"onMarkdown-help":e.markdownHelp},{default:c((function(){return[e.isMarkdownNeedHelp?Object(o["createVNode"])(n,{key:0,helpContent:e.DocMarkdownHelper},{default:c((function(){return[u]})),_:1},8,["helpContent"]):Object(o["createCommentVNode"])("",!0)]})),_:1},8,["markdown","onUpdate","onMarkdown-help"]):Object(o["createCommentVNode"])("",!0),0===e.blocks.length?(Object(o["openBlock"])(),Object(o["createBlock"])("div",d,"没有节点,按N添加Markdown")):Object(o["createCommentVNode"])("",!0)])})),s=(n("7db0"),n("d81d"),n("5530")),h=n("5502"),f=n("d257"),p=n("f138"),w=n("e6e0"),O=n("0d59"),_=n("5d9e");n("9b6a");hotkeys=window.hotkeys;var b={name:"PageBlocks",components:{WindowHelp:p["a"],Markdown:w["a"]},data:function(){return{blocks:[],blockOpenid:"",delay:"",DocPageBlocksHelper:_["b"],DocMarkdownHelper:_["a"],isNeedHelp:!0,isMarkdownNeedHelp:!0,showMarkdown:!1,page:{},title:""}},computed:{markdown:function(){var e=this;return this.blocks.find((function(t){return t.openid===e.blockOpenid}))}},mounted:function(){this.init(),hotkeys("n","pageBlocks",this.addNew),hotkeys("ctrl+h","pageBlocks",this.showHelp),hotkeys.setScope("pageBlocks")},unmounted:function(){hotkeys.unbind("n","pageBlocks",this.addNew),hotkeys.unbind("ctrl+h","pageBlocks",this.showHelp),hotkeys.setScope("all")},methods:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(h["d"])(["updateNote"])),Object(h["b"])(["addBlock","reload"])),{},{addNew:function(e){if(this.page.openid){var t=new O["a"]({parent:this.page.openid,type:O["b"].Markdown});this.addBlock(t),e.preventDefault()}else alert("添加失败")},changeTitle:function(e){var t=e.target.innerHTML;this.title=t,this.delay=this.debounceFun(t)},debounceFun:Object(f["a"])(2e3,!1,(function(e){var t=new O["e"](this.page);t.update({title:e}),this.updateNote(t),this.delay=""})),init:function(){var e=this.$route.params.openid;this.page=this.$store.getters.getPage(e),this.blocks=this.$store.getters.getBlocks(e)},markdownHelp:function(){this.isMarkdownNeedHelp=!this.isMarkdownNeedHelp},onShowMarkdown:function(e){this.blockOpenid=e.openid,this.showMarkdown=!0},parse:function(e){return""!==e&&e?Object(f["j"])(e):Object(f["j"])("markdown内容为空")},showHelp:function(e,t){this.isNeedHelp=!this.isNeedHelp,console.log("event",e,t),e.preventDefault()},updatePage:function(e){var t=new O["e"](this.page);t.update({title:e}),this.updateNote(t)},updatePageTitleByBlur:function(){this.delay&&this.delay.cancel(),this.updatePage(this.title)},update:function(e){var t,n=!1,o=[];this.blocks=this.blocks.map((function(c){return c.openid===e.openid?(t=new O["a"](c),t.value=e.value,t.setHash(),n=t.hash!==c.hash,n&&t.updateTime(),o.push(t.hash),t):(o.push(c.hash),c)})),n&&this.updateNote(t),this.showMarkdown=!1,hotkeys.setScope("pageBlocks"),this.reload()}})};n("f62f");b.render=l,b.__scopeId="data-v-52c1a1c8";t["default"]=b},e6e0:function(e,t,n){"use strict";var o=n("7a23"),c={class:"markdown-edit-content"},i={class:"content-left"};function a(e,t){var n=Object(o["resolveComponent"])("Cover");return Object(o["openBlock"])(),Object(o["createBlock"])(n,null,{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])("div",{class:"markdown-edit",style:{pointerEvents:e.isShowRight||e.isShowLeft?"auto":"none"}},[Object(o["renderSlot"])(e.$slots,"default"),Object(o["createVNode"])("div",c,[Object(o["createVNode"])(o["Transition"],{name:"reslide-fade"},{default:Object(o["withCtx"])((function(){return[Object(o["withDirectives"])(Object(o["createVNode"])("div",i,[Object(o["createVNode"])("div",{id:"editor",onChange:t[1]||(t[1]=function(){return e.onChangeAce.apply(e,arguments)}),onClick:t[2]||(t[2]=function(t){return e.onChangeLeft(!0)})},null,32)],512),[[o["vShow"],e.isShowLeft]])]})),_:1}),Object(o["createVNode"])(o["Transition"],{name:"slide-fade"},{default:Object(o["withCtx"])((function(){return[e.isShowRight?(Object(o["openBlock"])(),Object(o["createBlock"])("div",{key:0,class:"content-right",ref:"rightElement",style:{width:e.isShowLeft?"45%":"100%"}},[Object(o["createVNode"])("div",{class:"markdown-preview",ref:"markdown-preview",innerHTML:e.html,tabindex:"1",contenteditable:!0,onInput:t[3]||(t[3]=function(){return e.onChangeContent.apply(e,arguments)}),onClick:t[4]||(t[4]=function(t){return e.onChangeLeft(!1)})},null,40,["innerHTML"])],4)):Object(o["createCommentVNode"])("",!0)]})),_:1})])],4)]})),_:3})}n("4de4");var r=n("6d4f"),u=n.n(r),d=n("3020"),l=(n("cdae"),n("d257")),s=n("9b6a"),h={name:"Markdown",components:{Cover:d["a"]},props:{markdown:{type:Object,default:function(){return{value:"##"}}}},data:function(){return{isShowRight:!0,isShowLeft:!0,editor:"",code:"code",html:"",isEditLeft:!0}},mounted:function(){this.$refs.rightElement;var e=u.a.edit("editor",{minLines:10,fontSize:12,tabSize:4,readOnly:!1,highlightActiveLine:!1,value:this.code});u.a.config.set("basePath","https://cdn.jsdelivr.net/npm/ace-builds@1.4.3/src-noconflict/"),e.getSession().setMode("ace/mode/markdown"),e.getSession().setUseWrapMode(!0),e.setShowPrintMargin(!1),this.editor=e,e.getSession().on("change",this.onChangeAce);var t=this.markdown.value||"code";e.setValue(t),e.clearSelection(),e.on("blur",this.onFinish),e.focus(),Object(s["a"])("ctrl+q,ctrl+l","markdown",this.onShowLeft),Object(s["a"])("ctrl+e","markdown",this.onShowRight),Object(s["a"])("ctrl+enter,ctrl+s","markdown",this.onOk),Object(s["a"])("esc","markdown",this.closeLeft),Object(s["a"])("ctrl+h","markdown",this.showHelp),s["a"].setScope("markdown"),s["a"].filter=function(){return!0}},unmounted:function(){s["a"].unbind("ctrl+q,ctrl+l","markdown",this.onShowLeft),s["a"].unbind("ctrl+e","markdown",this.onShowRight),s["a"].unbind("ctrl+enter,ctrl+s","markdown",this.onOk),s["a"].unbind("esc","markdown",this.closeLeft),s["a"].unbind("ctrl+h","markdown",this.showHelp),s["a"].setScope("all")},methods:{onShowLeft:function(e){this.isShowLeft=!this.isShowLeft,console.log("key",e),e.preventDefault()},onShowRight:function(e){this.isShowRight=!this.isShowRight,e.preventDefault()},onOk:function(e){this.onShowMarkdown(),e.preventDefault()},onChangeAce:function(){this.isEditLeft&&(this.text=this.editor.getValue(),this.html=Object(l["j"])(this.text))},onChangeContent:function(e){var t=e.target.innerHTML,n=Object(l["i"])(t);this.text=n,this.editor.setValue(n),this.editor.clearSelection()},onChangeLeft:function(e){this.isEditLeft=e},onFinish:function(){this.isEditLeft=!1},onShowMarkdown:function(){var e=this.markdown;e.value=this.text,this.$emit("update",e)},showHelp:function(e,t){this.$emit("markdown-help"),e.preventDefault()},closeLeft:function(e){this.isShowLeft||this.isShowRight?(this.isShowLeft&&this.isShowRight||this.isShowLeft&&!this.isShowRight||!this.isShowLeft&&this.isShowRight)&&(this.isShowLeft=!this.isShowLeft):this.onShowMarkdown(),e.preventDefault()}}};n("8d13");h.render=a;t["a"]=h},f138:function(e,t,n){"use strict";n("b0c0");var o=n("7a23"),c=Object(o["withScopeId"])("data-v-f4322df4");Object(o["pushScopeId"])("data-v-f4322df4");var i=Object(o["createVNode"])("small",null,"ctrl+h隐藏帮助",-1),a={class:"el-table"},r=Object(o["createVNode"])("tr",null,[Object(o["createVNode"])("th",null,"命名"),Object(o["createVNode"])("th",null,"按键"),Object(o["createVNode"])("th",null,"介绍")],-1);Object(o["popScopeId"])();var u=c((function(e,t){return Object(o["openBlock"])(),Object(o["createBlock"])("div",{class:"show-help el-card padding-8",style:e.showStyle},[Object(o["createTextVNode"])("帮助:"+Object(o["toDisplayString"])(e.showName),1),i,Object(o["createVNode"])("div",null,[Object(o["renderSlot"])(e.$slots,"default"),Object(o["createVNode"])("table",a,[r,(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(e.showIntroduce,(function(t,n){return Object(o["openBlock"])(),Object(o["createBlock"])("tr",{key:n+e.showName},[Object(o["createVNode"])("td",null,Object(o["toDisplayString"])(t.name),1),Object(o["createVNode"])("td",null,Object(o["toDisplayString"])(t.hotkey),1),Object(o["createVNode"])("td",null,[Object(o["createVNode"])("div",{innerHTML:t.introduce},null,8,["innerHTML"])])])})),128))])])],4)})),d=n("d257"),l={name:"WindowHelp",props:{helpContent:{type:Object,default:function(){return{name:function(){return"帮助"},introduce:function(){return[]},style:function(){return""}}}}},computed:{showIntroduce:function(){return this.helpContent.introduce()},showName:function(){return this.helpContent.name()},showStyle:function(){return Object(d["c"])(this.helpContent.style())}}};n("a3c2");l.render=u,l.__scopeId="data-v-f4322df4";t["a"]=l},f62f:function(e,t,n){"use strict";n("74e1")}}]);
//# sourceMappingURL=pageblock.9f77bf16.js.map